@page
@model ProtectedDiary.Pages.UserDiariesModel

@{
  ViewData["Title"] = "Index";
}

<div class="profile">
  <img class="icon" src="@Html.DisplayFor(model => model.Author.IconUrl)" alt="icon" width="104px" height="104px">
  <span class="profile-name">
    @Html.DisplayFor(model => model.Author.ScreenName)
  </span>
  <a href="https://twitter.com/@(Model.Author.ScreenName)" class="profile-social" target="_brank" rel="noopener">
    <img src="~/content/twitter_social_icon.png" alt="twitter_social_icon" width="40" height="40">
  </a>
</div>

<div class="diaries-area">
  @if (Model.Author.Relationship == AuthorRelationship.You || Model.Author.Relationship ==
    AuthorRelationship.MutualFollowers)
  {
    <ul class="diaries-body">
      @foreach (var diary in Model.Diaries)
      {
        <li>
          <div class="diaryList-item">
            <a class="diaryList-link" asp-page="/Diary" asp-route-userId="@diary.UserId" asp-route-id="@diary.Id"></a>
            <div class="diaryList-body">
              <div class="diaryList-header">@Html.DisplayFor(modelItem =>
                                           diary.Title)</div>
              <div class="diaryList-date">投稿時間: @Html.DisplayFor(modelItem =>
                                               diary.CreatedAt)</div>
            </div>
            @if (Model.Author.Relationship == AuthorRelationship.You)
            {
              <div class="diaryList-edit">
                <a class="button" asp-page="/Diaries/Edit" asp-route-id="@diary.Id">編集</a>
              </div>

              <div class="diaryList-delete">
                <form class="form" asp-page="Diaries/Delete" asp-route-id="@diary.Id" method="post">
                  <delete-button></delete-button>
                </form>
              </div>
            }
        </li>
      }
    </ul>
  }
  else
  {
    <h1>相互フォローでないので見れません</h1>
  }

</div>

@{
  var prevDisabled = !Model.Diaries.HasPreviousPage ? "disabled" : "";
  var nextDisabled = !Model.Diaries.HasNextPage ? "disabled" : "";
}

<div class="pagination-block">
  <a asp-page="/UserDiaries" class="button @prevDisabled" asp-route-userId="@Model.Author.Id"
    asp-route-pageIndex="@(Model.Diaries.PageIndex - 1)">前ページ</a>
  <a asp-page="/UserDiaries" class="button @nextDisabled" asp-route-userId="@Model.Author.Id"
    asp-route-pageIndex="@(Model.Diaries.PageIndex + 1)">次ページ</a>
</div>